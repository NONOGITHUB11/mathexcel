<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SpÃ© Math Excellence â€” Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0A0A0F;--s1:#111118;--s2:#18181F;--s3:#22222C;--br:rgba(255,255,255,.07);--brh:rgba(255,255,255,.12);--tx:#F2F2F5;--mu:#7A7A8C;--acc:#7C5CFC;--acc2:#A78BFA;--gold:#F5C842;--green:#34D399;--red:#F87171;--blue:#60A5FA;--glow:rgba(124,92,252,.2);--r:14px}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--tx);min-height:100vh;display:flex}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(124,92,252,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(124,92,252,.03) 1px,transparent 1px);background-size:32px 32px;pointer-events:none;z-index:0}
.sb{width:220px;flex-shrink:0;background:var(--s1);border-right:1px solid var(--br);display:flex;flex-direction:column;padding:22px 0;position:sticky;top:0;height:100vh;z-index:10}
.sb-logo{padding:0 18px 22px;border-bottom:1px solid var(--br);margin-bottom:14px}
.sb-mark{width:36px;height:36px;background:linear-gradient(135deg,var(--acc),var(--acc2));border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:13px;font-weight:800;color:#fff;margin-bottom:10px;box-shadow:0 4px 14px var(--glow)}
.sb-title{font-family:'Syne',sans-serif;font-size:15px;font-weight:800}
.sb-by{font-size:10px;color:var(--mu);margin-top:2px}
.sb-by span{color:var(--gold)}
.sb-sub{font-size:10px;color:var(--mu);margin-top:1px}
.sb-sec{font-size:10px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--mu);padding:10px 18px 5px}
.sb-a{display:flex;align-items:center;gap:9px;padding:8px 18px;font-size:13px;font-weight:500;color:var(--mu);cursor:pointer;transition:all .15s;border-left:2px solid transparent;text-decoration:none}
.sb-a:hover{color:var(--tx);background:var(--s2)}
.sb-a.on{color:var(--tx);background:rgba(124,92,252,.1);border-left-color:var(--acc)}
.sb-a .ic{font-size:14px;width:16px;text-align:center}
.sb-foot{margin-top:auto;padding:14px 18px 0;border-top:1px solid var(--br)}
.view-a{display:flex;align-items:center;gap:8px;width:100%;background:var(--s2);border:1px solid var(--br);border-radius:9px;padding:9px 12px;color:var(--mu);font-size:12px;cursor:pointer;text-decoration:none;transition:all .15s}
.view-a:hover{color:var(--tx);border-color:var(--brh)}
.main{flex:1;min-width:0;position:relative;z-index:1}
.topbar{padding:18px 28px;border-bottom:1px solid var(--br);display:flex;align-items:center;justify-content:space-between;background:rgba(10,10,15,.85);backdrop-filter:blur(12px);position:sticky;top:0;z-index:5}
.topbar h1{font-family:'Syne',sans-serif;font-size:19px;font-weight:800}
.topbar p{font-size:12px;color:var(--mu);margin-top:2px}
.sv-btn{display:flex;align-items:center;gap:7px;background:linear-gradient(135deg,var(--acc),var(--acc2));color:#fff;border:none;border-radius:9px;padding:9px 18px;font-family:'Syne',sans-serif;font-size:12px;font-weight:700;cursor:pointer;box-shadow:0 4px 14px var(--glow);transition:all .15s}
.sv-btn:hover{transform:translateY(-1px)}
.panel{display:none;padding:28px}.panel.on{display:block}
.sh{margin-bottom:22px;padding-bottom:14px;border-bottom:1px solid var(--br)}
.sh h2{font-family:'Syne',sans-serif;font-size:17px;font-weight:700}
.sh p{font-size:13px;color:var(--mu);margin-top:3px}
.card{background:var(--s1);border:1px solid var(--br);border-radius:var(--r);padding:22px;margin-bottom:18px}
.ctit{font-family:'Syne',sans-serif;font-size:14px;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:7px}
.ch{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.f{margin-bottom:14px}
.f label{display:block;font-size:11px;font-weight:600;letter-spacing:.5px;color:var(--mu);text-transform:uppercase;margin-bottom:6px}
.f input,.f textarea,.f select{width:100%;background:var(--s2);border:1px solid var(--br);border-radius:9px;padding:10px 12px;font-family:'DM Sans',sans-serif;font-size:13px;color:var(--tx);outline:none;transition:border-color .15s,box-shadow .15s}
.f input:focus,.f textarea:focus,.f select:focus{border-color:var(--acc);box-shadow:0 0 0 3px var(--glow)}
.f input::placeholder,.f textarea::placeholder{color:var(--mu)}
.f textarea{resize:vertical;min-height:70px}
.f select option{background:var(--s2)}
.fr2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.add-btn{display:flex;align-items:center;justify-content:center;gap:7px;width:100%;padding:10px;background:none;border:1px dashed var(--br);border-radius:9px;color:var(--mu);font-size:13px;cursor:pointer;transition:all .15s;margin-top:7px}
.add-btn:hover{border-color:var(--acc);color:var(--acc2);background:rgba(124,92,252,.05)}
.li{display:flex;align-items:center;gap:11px;padding:11px 13px;background:var(--s2);border:1px solid var(--br);border-radius:9px;margin-bottom:7px}
.li:hover{border-color:var(--brh)}
.li-ic{font-size:18px;flex-shrink:0}
.li-info{flex:1;min-width:0}
.li-name{font-size:14px;font-weight:500}
.li-meta{font-size:12px;color:var(--mu);margin-top:1px}
.badge{font-size:11px;font-weight:600;padding:3px 8px;border-radius:20px;flex-shrink:0}
.bg{background:rgba(52,211,153,.15);color:var(--green)}
.bo{background:rgba(245,200,66,.15);color:var(--gold)}
.br2{background:var(--s3);color:var(--mu)}
.del{background:none;border:none;color:var(--mu);cursor:pointer;padding:4px 7px;border-radius:5px;font-size:13px;transition:all .15s;flex-shrink:0}
.del:hover{background:rgba(248,113,113,.1);color:var(--red)}

/* STUDENT GRID */
.sg{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:12px;margin-bottom:18px}
.sc{background:var(--s2);border:1px solid var(--br);border-radius:12px;padding:14px;position:relative;cursor:pointer;transition:all .15s}
.sc:hover{border-color:var(--acc)}
.sc-top{display:flex;align-items:center;gap:11px;margin-bottom:12px}
.sc-av{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-weight:700;font-size:15px;color:#fff;flex-shrink:0}
.sc-name{font-size:14px;font-weight:600}
.sc-email{font-size:12px;color:var(--mu)}
.sc-del{position:absolute;top:9px;right:9px;background:none;border:none;color:var(--mu);cursor:pointer;padding:4px;border-radius:5px;font-size:13px;transition:all .15s}
.sc-del:hover{background:rgba(248,113,113,.1);color:var(--red)}
.sc-sf{display:flex;align-items:center;gap:7px;margin-bottom:7px}
.sc-sf label{font-size:10px;color:var(--mu);width:55px;flex-shrink:0;font-weight:600;text-transform:uppercase;letter-spacing:.3px}
.sc-sf input{flex:1;background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:6px 9px;font-size:12px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none;transition:border-color .15s}
.sc-sf input:focus{border-color:var(--acc)}
.view-stu-btn{display:flex;align-items:center;justify-content:center;gap:6px;width:100%;padding:8px;background:rgba(124,92,252,.1);border:1px solid rgba(124,92,252,.3);border-radius:8px;color:var(--acc2);font-size:12px;font-weight:600;cursor:pointer;margin-top:10px;transition:all .15s}
.view-stu-btn:hover{background:rgba(124,92,252,.2)}

/* STUDENT DASHBOARD VIEW */
.stu-dash-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(6px);z-index:50;overflow-y:auto}
.stu-dash-overlay.open{display:flex;flex-direction:column}
.sdo-header{background:var(--s1);border-bottom:1px solid var(--br);padding:18px 28px;display:flex;align-items:center;gap:14px;position:sticky;top:0;z-index:5}
.sdo-back{background:var(--s2);border:1px solid var(--br);border-radius:9px;padding:8px 14px;font-size:13px;color:var(--mu);cursor:pointer;transition:all .15s}
.sdo-back:hover{color:var(--tx)}
.sdo-title{font-family:'Syne',sans-serif;font-size:18px;font-weight:700}
.sdo-body{flex:1;padding:28px;max-width:900px;margin:0 auto;width:100%}
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:22px}
.stat{background:var(--s1);border:1px solid var(--br);border-radius:14px;padding:18px;position:relative;overflow:hidden}
.stat::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.c1::before{background:linear-gradient(90deg,var(--acc),var(--acc2))}
.c2::before{background:linear-gradient(90deg,var(--gold),#ffaa00)}
.c3::before{background:linear-gradient(90deg,var(--green),#00d4aa)}
.c4::before{background:linear-gradient(90deg,var(--blue),#0080c0)}
.sl{font-size:10px;font-weight:700;letter-spacing:1px;color:var(--mu);text-transform:uppercase}
.sv{font-family:'Syne',sans-serif;font-size:24px;font-weight:800;margin:7px 0 3px}
.ss{font-size:12px;color:var(--mu)}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}

/* WEEK GRID */
.wg{background:var(--s2);border:1px solid var(--br);border-radius:11px;overflow:hidden}
.wgr{display:grid;grid-template-columns:56px 1fr;border-bottom:1px solid var(--br)}
.wgr:last-child{border-bottom:none}
.wgd{font-size:10px;font-weight:700;text-transform:uppercase;color:var(--mu);padding:11px 0 11px 14px;display:flex;align-items:flex-start;padding-top:13px}
.wgt{padding:7px 11px;display:flex;flex-wrap:wrap;gap:5px;align-items:flex-start}
.tc{display:inline-flex;align-items:center;gap:5px;padding:3px 9px;border-radius:5px;font-size:11px}
.tc.cours{background:rgba(124,92,252,.2);color:var(--acc2)}
.tc.exo{background:rgba(52,211,153,.15);color:var(--green)}
.tc.revise{background:rgba(245,200,66,.12);color:var(--gold)}
.cd{background:none;border:none;color:currentColor;opacity:.5;cursor:pointer;font-size:11px;padding:0}
.cd:hover{opacity:1}
.atr{display:flex;gap:5px;margin-top:4px;flex-wrap:wrap;width:100%}
.at-in{flex:1;min-width:120px;background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:5px 9px;font-size:11px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none}
.at-in:focus{border-color:var(--acc)}
.at-sel{background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:5px 7px;font-size:11px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none}
.at-btn{background:var(--acc);color:#fff;border:none;border-radius:7px;padding:5px 10px;font-size:11px;font-weight:600;cursor:pointer}

/* CHAPTERS */
.chap-it{display:flex;align-items:stretch;background:var(--s2);border:1px solid var(--br);border-radius:11px;margin-bottom:7px;overflow:hidden}
.chap-num{width:42px;background:linear-gradient(135deg,rgba(74,42,143,.8),rgba(108,63,197,.6));display:flex;align-items:center;justify-content:center;font-family:'Syne',sans-serif;font-size:12px;font-weight:700;color:#fff;flex-shrink:0}
.chap-body{flex:1;padding:12px 14px}
.chap-top{display:flex;align-items:center;gap:9px;margin-bottom:10px}
.chap-ni{flex:1;background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:6px 9px;font-size:13px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none}
.chap-ni:focus{border-color:var(--acc)}
.chap-st{background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:6px 9px;font-size:11px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none;cursor:pointer;flex-shrink:0}
.chap-links{display:grid;grid-template-columns:1fr 1fr 1fr;gap:7px}
.cl-f{display:flex;align-items:center;gap:5px}
.cl-f label{font-size:10px;color:var(--mu);white-space:nowrap;font-weight:600;width:45px;flex-shrink:0}
.cl-f input{flex:1;background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:5px 8px;font-size:11px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none}
.cl-f input:focus{border-color:var(--acc)}
.cl-f input::placeholder{color:var(--mu)}
.chap-desc{width:100%;margin-top:8px;background:var(--s1);border:1px solid var(--br);border-radius:7px;padding:6px 9px;font-size:12px;color:var(--tx);font-family:'DM Sans',sans-serif;outline:none;resize:vertical;min-height:50px}
.chap-desc::placeholder{color:var(--mu)}
.chap-desc:focus{border-color:var(--acc)}

/* CAL ADD */
.cal-add-sec{border-top:1px solid var(--br);padding-top:16px;margin-top:16px}
.cal-event-btn{display:flex;align-items:center;gap:8px;background:rgba(52,211,153,.1);border:1px solid rgba(52,211,153,.3);border-radius:9px;padding:9px 14px;color:var(--green);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s;width:100%}
.cal-event-btn:hover{background:rgba(52,211,153,.18)}

/* OBJECTIFS */
.oi{display:flex;align-items:center;gap:10px;padding:11px 13px;background:var(--s2);border:1px solid var(--br);border-radius:9px;margin-bottom:7px;font-size:13px}
.od{width:7px;height:7px;border-radius:50%;background:var(--acc);flex-shrink:0}
.inline-row{display:flex;gap:8px;margin-top:8px}
.ii{flex:1;background:var(--s2);border:1px solid var(--br);border-radius:9px;padding:9px 12px;font-family:'DM Sans',sans-serif;font-size:13px;color:var(--tx);outline:none}
.ii:focus{border-color:var(--acc)}
.ib{background:var(--acc);color:#fff;border:none;border-radius:9px;padding:9px 14px;font-size:13px;font-weight:600;cursor:pointer}

/* MEET */
.ms{display:flex;align-items:center;gap:9px;padding:11px 13px;background:var(--s2);border:1px solid var(--br);border-radius:9px;margin-top:11px;font-size:13px}
.md{width:8px;height:8px;border-radius:50%;background:var(--mu);flex-shrink:0}
.md.on{background:var(--green);box-shadow:0 0 6px var(--green)}

/* AGENDA PREVIEW */
.ap{background:var(--s2);border:1px solid var(--br);border-radius:11px;overflow:hidden;margin-top:14px}
.aph{height:180px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:11px;color:var(--mu);font-size:13px}

/* EVALS in student view */
.ev-it{padding:13px;background:var(--s2);border-radius:10px;border:1px solid var(--br);margin-bottom:8px}
.ev-hd2{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.ev-nm{font-size:14px;font-weight:600}
.ev-dt{font-size:12px;color:var(--mu)}
.ev-nt{font-family:'Syne',sans-serif;font-size:18px;font-weight:800}
.ev-nt.good{color:var(--green)}.ev-nt.ok{color:var(--gold)}.ev-nt.bad{color:var(--red)}
.ev-cm{font-size:12px;color:var(--mu);margin-top:5px;line-height:1.5}
.src-b{font-size:10px;padding:2px 6px;border-radius:4px;color:var(--acc2);background:rgba(124,92,252,.15);margin-left:5px}

/* TOAST */
.toast{position:fixed;bottom:22px;right:22px;background:var(--s2);border:1px solid var(--green);color:var(--green);border-radius:11px;padding:12px 17px;font-size:13px;font-weight:500;display:flex;align-items:center;gap:8px;transform:translateY(80px);opacity:0;transition:all .3s cubic-bezier(.34,1.56,.64,1);z-index:200;box-shadow:0 8px 32px rgba(0,0,0,.4)}
.toast.show{transform:translateY(0);opacity:1}
</style>
</head>
<body>

<aside class="sb">
  <div class="sb-logo">
    <div class="sb-mark">M&#x2211;</div>
    <div class="sb-title">SpÃ© Math Excellence</div>
    <div class="sb-by">par <span>Noah Guiraud</span></div>
    <div class="sb-sub">Panneau Admin</div>
  </div>
  <div class="sb-sec">Gestion</div>
  <a class="sb-a on" onclick="sp('eleves',this)" href="#"><span class="ic">ğŸ‘¨â€ğŸ“</span>Ã‰lÃ¨ves</a>
  <a class="sb-a" onclick="sp('agenda',this)" href="#"><span class="ic">ğŸ“…</span>Agenda & Meet</a>
  <a class="sb-a" onclick="sp('planning',this)" href="#"><span class="ic">ğŸ—“ï¸</span>Planning semaine</a>
  <a class="sb-a" onclick="sp('cours',this)" href="#"><span class="ic">ğŸ“š</span>Cours & ressources</a>
  <a class="sb-a" onclick="sp('replays',this)" href="#"><span class="ic">ğŸ¥</span>Replays</a>
  <a class="sb-a" onclick="sp('evals',this)" href="#"><span class="ic">ğŸ“Š</span>Ã‰valuations</a>
  <a class="sb-a" onclick="sp('obj',this)" href="#"><span class="ic">ğŸ¯</span>Objectifs</a>
  <div class="sb-sec">Contenu</div>
  <a class="sb-a" onclick="sp('msg',this)" href="#"><span class="ic">ğŸ’¬</span>Message coach</a>
  <div class="sb-foot">
    <a class="view-a" href="index.html" target="_blank"><span>ğŸ‘ï¸</span>Voir le site Ã©lÃ¨ve</a>
  </div>
</aside>

<main class="main">
  <div class="topbar">
    <div><h1 id="ptit">Ã‰lÃ¨ves</h1><p id="psub">Gestion des Ã©lÃ¨ves inscrits</p></div>
    <button class="sv-btn" onclick="saveAll()">ğŸ’¾ Sauvegarder</button>
  </div>

  <!-- Ã‰LÃˆVES -->
  <div class="panel on" id="panel-eleves">
    <div class="sh"><h2>ğŸ‘¨â€ğŸ“ Ã‰lÃ¨ves inscrits</h2><p>Clique sur "Voir le tableau de bord" pour voir oÃ¹ en est un Ã©lÃ¨ve.</p></div>
    <div class="sg" id="stuGrid"></div>
    <div class="card">
      <div class="ctit">â• Ajouter un Ã©lÃ¨ve</div>
      <div class="fr2">
        <div class="f"><label>PrÃ©nom</label><input id="nName" placeholder="Thomas"/></div>
        <div class="f"><label>Email</label><input type="email" id="nEmail" placeholder="thomas@email.com"/></div>
      </div>
      <div class="fr2">
        <div class="f"><label>Mot de passe</label><input id="nPass" placeholder="maths2025"/></div>
        <div class="f"><label>Couleur</label>
          <select id="nColor">
            <option value="linear-gradient(135deg,#6C3FC5,#8B62D9)">Violet</option>
            <option value="linear-gradient(135deg,#F5C842,#FF9800)">Or</option>
            <option value="linear-gradient(135deg,#2ECC8A,#0080C0)">Ã‰meraude</option>
            <option value="linear-gradient(135deg,#F87171,#FC4A8B)">Rose</option>
            <option value="linear-gradient(135deg,#60A5FA,#3B82F6)">Bleu</option>
          </select>
        </div>
      </div>
      <button class="add-btn" onclick="addStudent()">â• Ajouter</button>
    </div>
  </div>

  <!-- AGENDA -->
  <div class="panel" id="panel-agenda">
    <div class="sh"><h2>ğŸ“… Agenda & Google Meet</h2><p>Configure l'agenda affichÃ© et la prochaine sÃ©ance.</p></div>
    <div class="card">
      <div class="ctit">ğŸ”— Google Agenda (admin)</div>
      <div class="f"><label>URL iframe Google Agenda</label><input type="url" id="agUrl" placeholder="https://calendar.google.com/calendar/embed?src=..." oninput="updateAgPrev()"/></div>
      <div style="font-size:12px;color:var(--mu);margin-bottom:10px;line-height:1.6">ğŸ“Œ Agenda â†’ âš™ï¸ ParamÃ¨tres â†’ ton agenda â†’ "IntÃ©grer l'agenda" â†’ copie le src="..."</div>
      <div class="ap" id="agPrev"><div class="aph"><span style="font-size:32px">ğŸ“…</span><span>Colle l'URL pour voir un aperÃ§u</span></div></div>
      <div class="cal-add-sec">
        <div style="font-size:13px;font-weight:600;color:var(--tx);margin-bottom:12px">â• Ajouter un Ã©vÃ©nement Ã  mon Google Calendar</div>
        <div class="fr2">
          <div class="f"><label>Titre</label><input id="aEvTit" placeholder="ex: Cours suites"/></div>
          <div class="f"><label>Date (YYYYMMDD)</label><input id="aEvDate" placeholder="20250301"/></div>
        </div>
        <div class="fr2">
          <div class="f"><label>Heure dÃ©but (HHMM)</label><input id="aEvStart" placeholder="1400"/></div>
          <div class="f"><label>Heure fin (HHMM)</label><input id="aEvEnd" placeholder="1530"/></div>
        </div>
        <div class="f"><label>Description</label><input id="aEvDesc" placeholder="Notes..."/></div>
        <button class="cal-event-btn" onclick="addAdminEvent()">ğŸ“… Ouvrir dans Google Calendar</button>
      </div>
    </div>
    <div class="card">
      <div class="ctit">ğŸ“¹ Prochaine sÃ©ance Google Meet</div>
      <div class="fr2">
        <div class="f"><label>Titre</label><input id="mTit" placeholder="Limites de suites"/></div>
        <div class="f"><label>Date et heure</label><input id="mDate" placeholder="Samedi 1 mars Â· 14h00"/></div>
      </div>
      <div class="f"><label>Lien Google Meet</label><input type="url" id="mUrl" placeholder="https://meet.google.com/xxx-xxxx-xxx"/></div>
      <div class="ms"><div class="md" id="mDot"></div><span id="mTxt" style="color:var(--mu)">Aucune sÃ©ance configurÃ©e</span></div>
    </div>
  </div>

  <!-- PLANNING -->
  <div class="panel" id="panel-planning">
    <div class="sh"><h2>ğŸ—“ï¸ Planning semaine</h2><p>Configure les tÃ¢ches jour par jour pour tous les Ã©lÃ¨ves.</p></div>
    <div class="card"><div class="ctit">Semaine en cours</div><div class="wg" id="weekGrid"></div></div>
  </div>

  <!-- COURS -->
  <div class="panel" id="panel-cours">
    <div class="sh"><h2>ğŸ“š Cours & ressources</h2><p>Tous les chapitres sont partagÃ©s entre tous les Ã©lÃ¨ves. Colle les liens Google Drive pour les fiches PDF, vidÃ©os et exercices.</p></div>
    <div class="card">
      <div class="ch">
        <div class="ctit" style="margin-bottom:0">Liste des chapitres</div>
        <button class="add-btn" style="width:auto;margin:0;padding:7px 14px" onclick="addChap()">â• Nouveau chapitre</button>
      </div>
      <div style="margin-top:14px" id="chapList"></div>
    </div>
  </div>

  <!-- REPLAYS -->
  <div class="panel" id="panel-replays">
    <div class="sh"><h2>ğŸ¥ Replays</h2><p>Liens vers les enregistrements Google Drive ou YouTube.</p></div>
    <div class="card">
      <div class="ctit">â• Ajouter un replay</div>
      <div class="fr2">
        <div class="f"><label>Titre</label><input id="rTit" placeholder="SÃ©ance 13 â€” Limites avancÃ©es"/></div>
        <div class="f"><label>Date</label><input id="rDate" placeholder="1 mar 2025"/></div>
      </div>
      <div class="fr2">
        <div class="f"><label>DurÃ©e</label><input id="rDur" placeholder="1h30"/></div>
        <div class="f"><label>Lien</label><input type="url" id="rUrl" placeholder="https://drive.google.com/..."/></div>
      </div>
      <button class="add-btn" onclick="addReplay()">â• Ajouter</button>
    </div>
    <div class="card"><div class="ctit">ğŸ“‹ Replays</div><div id="replayList"></div><div id="noR" style="display:none;text-align:center;padding:22px;color:var(--mu);font-size:14px">Aucun replay.</div></div>
  </div>

  <!-- EVALS -->
  <div class="panel" id="panel-evals">
    <div class="sh"><h2>ğŸ“Š Ã‰valuations (coach)</h2><p>Les Ã©lÃ¨ves peuvent aussi ajouter leurs notes depuis leur espace.</p></div>
    <div class="card">
      <div class="ctit">â• Ajouter</div>
      <div class="fr2">
        <div class="f"><label>Nom du DS</label><input id="eName" placeholder="DS Suites â€” RÃ©currence"/></div>
        <div class="f"><label>Date</label><input id="eDate" placeholder="1 mar 2025"/></div>
      </div>
      <div class="fr3">
        <div class="f"><label>Note</label><input type="number" id="eNote" placeholder="15"/></div>
        <div class="f"><label>Sur</label><input type="number" id="eMax" value="20"/></div>
        <div class="f"><label>Couleur</label><select id="eCls"><option value="good">ğŸŸ¢ Bon</option><option value="ok">ğŸŸ¡ Moyen</option><option value="bad">ğŸ”´ Ã€ retravailler</option></select></div>
      </div>
      <div class="f"><label>Commentaire</label><textarea id="eCmt" placeholder="Retour personnalisÃ©..."></textarea></div>
      <div class="f"><label>Tags</label><input id="eTags" placeholder="RÃ©currence, Suites..."/></div>
      <button class="add-btn" onclick="addEval()">â• Ajouter</button>
    </div>
    <div class="card"><div class="ctit">ğŸ“‹ Ã‰valuations</div><div id="evalList"></div><div id="noE" style="display:none;text-align:center;padding:22px;color:var(--mu);font-size:14px">Aucune Ã©valuation.</div></div>
  </div>

  <!-- OBJECTIFS -->
  <div class="panel" id="panel-obj">
    <div class="sh"><h2>ğŸ¯ Objectifs</h2><p>Objectifs affichÃ©s Ã  tous les Ã©lÃ¨ves. Ils peuvent aussi en ajouter des personnels.</p></div>
    <div class="card">
      <div class="ctit">Objectifs actuels</div>
      <div id="objList"></div>
      <div class="inline-row">
        <input class="ii" id="newObj" placeholder="Nouvel objectif pour tous..."/>
        <button class="ib" onclick="addObj()">Ajouter</button>
      </div>
    </div>
  </div>

  <!-- MESSAGE -->
  <div class="panel" id="panel-msg">
    <div class="sh"><h2>ğŸ’¬ Message du coach</h2><p>AffichÃ© dans l'espace objectifs des Ã©lÃ¨ves.</p></div>
    <div class="card">
      <div class="ctit">âœï¸ Message de la semaine</div>
      <div class="f"><label>Titre</label><input id="msgTit" placeholder="Semaine du 24 fÃ©vrier"/></div>
      <div class="f"><label>Message</label><textarea id="msgBody" style="min-height:110px" placeholder="Beau travail la semaine derniÃ¨re..."></textarea></div>
      <div class="f"><label>Call to action</label><input id="msgCta" placeholder="Objectif : finir les exos avant samedi ğŸ’ª"/></div>
      <button class="add-btn" onclick="saveMsg()">âœ… Sauvegarder</button>
      <div style="margin-top:14px;padding:13px;background:var(--s2);border-radius:9px;border:1px solid var(--br)">
        <div style="font-size:10px;color:var(--mu);text-transform:uppercase;font-weight:600;letter-spacing:.5px;margin-bottom:7px">AperÃ§u</div>
        <div id="msgPrev" style="font-size:13px;line-height:1.7;color:var(--mu)">â€”</div>
      </div>
    </div>
  </div>
</main>

<!-- STUDENT DASHBOARD OVERLAY -->
<div class="stu-dash-overlay" id="stuDash">
  <div class="sdo-header">
    <button class="sdo-back" onclick="closeStuDash()">â† Retour</button>
    <div>
      <div class="sdo-title" id="sdoTitle">Tableau de bord â€” Ã‰lÃ¨ve</div>
      <div style="font-size:12px;color:var(--mu);margin-top:2px">Vue admin â€” Toutes les donnÃ©es de cet Ã©lÃ¨ve</div>
    </div>
  </div>
  <div class="sdo-body">
    <div class="stats-row" id="sdStats"></div>
    <div class="g2">
      <div class="card">
        <div class="ctit">ğŸ“Š Ã‰valuations (toutes)</div>
        <div id="sdEvals"></div>
        <div id="sdNoE" style="display:none;text-align:center;padding:18px;color:var(--mu);font-size:13px">Aucune Ã©valuation.</div>
      </div>
      <div>
        <div class="card">
          <div class="ctit">ğŸ“ˆ Progression</div>
          <div id="sdProg"></div>
        </div>
        <div class="card">
          <div class="ctit">ğŸ¯ Objectifs</div>
          <div id="sdObj"></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="ctit">ğŸ—’ï¸ Infos connexion</div>
      <div id="sdInfo" style="font-size:13px;line-height:2;color:var(--mu)"></div>
    </div>
  </div>
</div>

<div class="toast" id="toast">âœ“ <span id="toastMsg"></span></div>

<script>
// AUTH
const AP='admin2025';
if(sessionStorage.getItem('sme_admin')!=='yes'){
  const p=prompt('ğŸ”’ Mot de passe administrateur :');
  if(p!==AP){document.body.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;color:#aaa;font-size:18px">AccÃ¨s refusÃ©.</div>';}
  else sessionStorage.setItem('sme_admin','yes');
}

const SK='sme_state';
const DEF={
  students:[{name:'Thomas',email:'thomas@email.com',pass:'maths2024',color:'linear-gradient(135deg,#6C3FC5,#8B62D9)'},{name:'LÃ©a',email:'lea@email.com',pass:'maths2024',color:'linear-gradient(135deg,#F5C842,#FF9800)'}],
  agendaUrl:'',meetTitle:'',meetDate:'',meetUrl:'',
  weekPlan:[{day:'LUN',tasks:[]},{day:'MAR',tasks:[{text:'VidÃ©o cours',type:'cours'}]},{day:'MER',tasks:[{text:'Exercices niv.1',type:'exo'}]},{day:'JEU',tasks:[{text:'RÃ©vision fiche',type:'revise'}]},{day:'VEN',tasks:[{text:'Exercices niv.2',type:'exo'}]},{day:'SAM',tasks:[{text:'Cours 14h-15h30',type:'cours'}]},{day:'DIM',tasks:[]}],
  chapters:[
    {num:1,name:'Suites â€” Raisonnement par rÃ©currence',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'done',fiche:'',video:'',exercices:''},
    {num:2,name:'Suites â€” Limites',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'current',fiche:'',video:'',exercices:''},
    {num:3,name:'Suites â€” OpÃ©rations sur les limites',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:4,name:'DÃ©rivation',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'done',fiche:'',video:'',exercices:''},
    {num:5,name:'Fonction exponentielle',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:6,name:'Fonctions trigonomÃ©triques',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:7,name:'Produit scalaire',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:8,name:'GÃ©omÃ©trie repÃ©rÃ©e',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:9,name:'ProbabilitÃ©s conditionnelles',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'done',fiche:'',video:'',exercices:''},
    {num:10,name:'Variables alÃ©atoires',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'done',fiche:'',video:'',exercices:''},
    {num:11,name:'Loi binomiale',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
    {num:12,name:'Algorithmique Python',meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''},
  ],
  replays:[],evals:[],
  objectives:[{text:'Regarder la vidÃ©o du cours',done:false,source:'coach'},{text:'Lire la fiche mÃ©thode',done:false,source:'coach'},{text:'Faire les exercices niveau 1',done:false,source:'coach'}],
  message:{title:'',body:'',cta:''},
};
let state=JSON.parse(localStorage.getItem(SK)||'null')||DEF;
function save(){localStorage.setItem(SK,JSON.stringify(state));}
function getStuData(email){return JSON.parse(localStorage.getItem('sme_s_'+email)||'null')||{calUrl:'',evals:[],personalObjs:[],objDone:{}};}

// TOAST
let tt;
function toast(m,c='var(--green)'){const t=document.getElementById('toast');t.style.borderColor=c;t.style.color=c;document.getElementById('toastMsg').textContent=m;t.classList.add('show');clearTimeout(tt);tt=setTimeout(()=>t.classList.remove('show'),2500);}

// PANELS
const META={eleves:{t:'Ã‰lÃ¨ves',s:'Gestion des Ã©lÃ¨ves inscrits'},agenda:{t:'Agenda & Meet',s:'Calendrier et prochaine sÃ©ance'},planning:{t:'Planning semaine',s:'TÃ¢ches jour par jour'},cours:{t:'Cours & ressources',s:'Chapitres, fiches PDF, vidÃ©os et exercices'},replays:{t:'Replays',s:'Enregistrements des sÃ©ances'},evals:{t:'Ã‰valuations',s:'Notes et retours coach'},obj:{t:'Objectifs',s:'TÃ¢ches affichÃ©es aux Ã©lÃ¨ves'},msg:{t:'Message du coach',s:'AffichÃ© dans l\'espace objectifs'}};
const renders={eleves:renderStudents,agenda:renderAgenda,planning:renderPlanning,cours:renderCours,replays:renderReplays,evals:renderEvals,obj:renderObj,msg:renderMsg};
function sp(id,el){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.sb-a').forEach(n=>n.classList.remove('on'));
  document.getElementById('panel-'+id).classList.add('on');
  if(el)el.classList.add('on');
  document.getElementById('ptit').textContent=META[id].t;
  document.getElementById('psub').textContent=META[id].s;
  (renders[id]||Function)();
}

// â”€â”€ STUDENT VIEW
function openStuDash(email){
  const s=state.students.find(s=>s.email===email);
  if(!s)return;
  const sd=getStuData(email);
  const adminE=state.evals||[];
  const stuE=sd.evals||[];
  const allE=[...adminE.map(e=>({...e,src:'coach'})),...stuE.map(e=>({...e,src:'Ã©lÃ¨ve'}))];
  const done=(state.chapters||[]).filter(c=>c.status==='done').length;
  const avg=allE.length?(allE.reduce((t,e)=>t+(e.note/e.max*20),0)/allE.length).toFixed(1):'â€”';
  const best=allE.length?allE.reduce((b,e)=>e.note/e.max>b.note/b.max?e:b,allE[0]):null;

  document.getElementById('sdoTitle').textContent=`Tableau de bord â€” ${s.name}`;
  document.getElementById('sdStats').innerHTML=`
    <div class="stat c1"><div class="sl">SÃ©ances</div><div class="sv">${(state.replays||[]).length}</div><div class="ss">enregistrÃ©es</div></div>
    <div class="stat c2"><div class="sl">Moyenne</div><div class="sv">${avg}</div><div class="ss">sur 20</div></div>
    <div class="stat c3"><div class="sl">Chapitres</div><div class="sv">${done}/${(state.chapters||[]).length}</div><div class="ss">terminÃ©s</div></div>
    <div class="stat c4"><div class="sl">Ã‰vals</div><div class="sv">${allE.length}</div><div class="ss">total</div></div>`;

  // Evals
  const el=document.getElementById('sdEvals');el.innerHTML='';
  document.getElementById('sdNoE').style.display=allE.length?'none':'block';
  allE.forEach(e=>{
    const d=document.createElement('div');d.className='ev-it';
    d.innerHTML=`<div class="ev-hd2"><div><div class="ev-nm">${e.name}<span class="src-b">${e.src}</span></div><div class="ev-dt">${e.date}</div></div><div class="ev-nt ${e.noteClass}">${e.note}/${e.max}</div></div>${e.comment?`<div class="ev-cm">${e.comment}</div>`:''}`;
    el.appendChild(d);
  });

  // Progress
  const ch=state.chapters||[];
  document.getElementById('sdProg').innerHTML=`
    <div style="margin-bottom:12px"><div style="display:flex;justify-content:space-between;font-size:12px;color:var(--mu);margin-bottom:5px"><span>Chapitres terminÃ©s</span><span>${done}/${ch.length}</span></div><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div style="height:100%;border-radius:3px;background:linear-gradient(90deg,var(--acc),var(--acc2));width:${ch.length?Math.round(done/ch.length*100):0}%"></div></div></div>
    <div><div style="display:flex;justify-content:space-between;font-size:12px;color:var(--mu);margin-bottom:5px"><span>Ã‰valuations</span><span>${allE.length}</span></div><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div style="height:100%;border-radius:3px;background:linear-gradient(90deg,var(--acc),var(--acc2));width:${Math.min(allE.length*10,100)}%"></div></div></div>`;

  // Objectives
  const adminO=(state.objectives||[]);
  const persO=(sd.personalObjs||[]);
  const allO=[...adminO.map((o,i)=>({...o,key:'a'+i})),...persO.map((o,i)=>({...o,key:'p'+i}))];
  const od=document.getElementById('sdObj');od.innerHTML='';
  if(!allO.length){od.innerHTML='<div style="font-size:13px;color:var(--mu)">Aucun objectif.</div>';}
  else allO.forEach(o=>{
    const done2=sd.objDone&&sd.objDone[o.key]!==undefined?sd.objDone[o.key]:o.done;
    const el2=document.createElement('div');el2.style.cssText='display:flex;align-items:center;gap:8px;padding:8px 10px;background:var(--s2);border-radius:8px;font-size:12px;margin-bottom:6px';
    el2.innerHTML=`<div style="width:18px;height:18px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:11px;${done2?'background:rgba(52,211,153,.2);color:var(--green);border:1px solid var(--green)':'background:var(--s3);border:1px solid var(--br)'}">${done2?'âœ“':''}</div><span style="${done2?'text-decoration:line-through;color:var(--mu)':''}">${o.text}</span><span style="margin-left:auto;font-size:10px;color:var(--mu)">${o.source==='coach'?'coach':'perso'}</span>`;
    od.appendChild(el2);
  });

  // Info
  document.getElementById('sdInfo').innerHTML=`Email : <strong style="color:var(--tx)">${s.email}</strong><br/>Agenda connectÃ© : <strong style="color:var(--tx)">${sd.calUrl?'âœ“ Oui':'âœ— Non'}</strong><br/>Ã‰vals ajoutÃ©es : <strong style="color:var(--tx)">${stuE.length} par l'Ã©lÃ¨ve, ${adminE.length} par le coach</strong><br/>Objectifs perso : <strong style="color:var(--tx)">${(sd.personalObjs||[]).length}</strong>`;

  document.getElementById('stuDash').classList.add('open');
}
function closeStuDash(){document.getElementById('stuDash').classList.remove('open');}

// â”€â”€ STUDENTS
function renderStudents(){
  const g=document.getElementById('stuGrid');g.innerHTML='';
  state.students.forEach((s,i)=>{
    const c=document.createElement('div');c.className='sc';
    c.innerHTML=`<button class="sc-del" onclick="event.stopPropagation();delStu(${i})">âœ•</button>
    <div class="sc-top"><div class="sc-av" style="background:${s.color}">${s.name[0]}</div><div><div class="sc-name">${s.name}</div><div class="sc-email">${s.email}</div></div></div>
    <div class="sc-sf"><label>PrÃ©nom</label><input value="${s.name}" onclick="event.stopPropagation()" oninput="state.students[${i}].name=this.value;save()"/></div>
    <div class="sc-sf"><label>Email</label><input value="${s.email}" onclick="event.stopPropagation()" oninput="state.students[${i}].email=this.value;save()"/></div>
    <div class="sc-sf"><label>Pass</label><input value="${s.pass}" onclick="event.stopPropagation()" oninput="state.students[${i}].pass=this.value;save()"/></div>
    <button class="view-stu-btn" onclick="event.stopPropagation();openStuDash('${s.email}')">ğŸ‘ï¸ Voir le tableau de bord</button>`;
    g.appendChild(c);
  });
}
function addStudent(){
  const name=document.getElementById('nName').value.trim(),email=document.getElementById('nEmail').value.trim(),pass=document.getElementById('nPass').value.trim(),color=document.getElementById('nColor').value;
  if(!name||!email||!pass){toast('âš ï¸ Remplis tous les champs','var(--gold)');return;}
  state.students.push({name,email,pass,color});save();renderStudents();
  ['nName','nEmail','nPass'].forEach(id=>document.getElementById(id).value='');
  toast('âœ“ Ã‰lÃ¨ve ajoutÃ© !');
}
function delStu(i){if(confirm(`Supprimer ${state.students[i].name} ?`)){state.students.splice(i,1);save();renderStudents();toast('âœ“ SupprimÃ©');}}

// â”€â”€ AGENDA
function renderAgenda(){
  document.getElementById('agUrl').value=state.agendaUrl||'';
  document.getElementById('mTit').value=state.meetTitle||'';
  document.getElementById('mDate').value=state.meetDate||'';
  document.getElementById('mUrl').value=state.meetUrl||'';
  updateAgPrev();updateMeetSt();
  ['mTit','mDate','mUrl'].forEach(id=>{const el=document.getElementById(id);el.oninput=()=>{state[{mTit:'meetTitle',mDate:'meetDate',mUrl:'meetUrl'}[id]]=el.value;save();updateMeetSt();};});
}
function updateAgPrev(){const url=document.getElementById('agUrl').value.trim();state.agendaUrl=url;save();const p=document.getElementById('agPrev');p.innerHTML=url?`<iframe src="${url}" frameborder="0" scrolling="no" style="width:100%;height:320px;border:0"></iframe>`:`<div class="aph"><span style="font-size:32px">ğŸ“…</span><span>Colle l'URL pour voir un aperÃ§u</span></div>`;}
function updateMeetSt(){const url=document.getElementById('mUrl')?.value.trim()||'',tit=document.getElementById('mTit')?.value.trim()||'',date=document.getElementById('mDate')?.value.trim()||'';const dot=document.getElementById('mDot'),txt=document.getElementById('mTxt');if(url&&tit){dot.classList.add('on');txt.textContent=`âœ“ ${tit} â€” ${date}`;txt.style.color='var(--green)';}else{dot.classList.remove('on');txt.textContent='Aucune sÃ©ance configurÃ©e';txt.style.color='var(--mu)';}}
function addAdminEvent(){
  const title=document.getElementById('aEvTit').value.trim(),date=document.getElementById('aEvDate').value.trim(),start=document.getElementById('aEvStart').value.trim(),end=document.getElementById('aEvEnd').value.trim(),desc=document.getElementById('aEvDesc').value.trim();
  if(!title||!date){toast('âš ï¸ Titre et date requis','var(--gold)');return;}
  const dt=date.replace(/-/g,'');
  let url=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}`;
  if(start&&end)url+=`&dates=${dt}T${start}00/${dt}T${end}00`;else url+=`&dates=${dt}/${dt}`;
  if(desc)url+=`&details=${encodeURIComponent(desc)}`;
  window.open(url,'_blank');['aEvTit','aEvDate','aEvStart','aEvEnd','aEvDesc'].forEach(id=>document.getElementById(id).value='');
  toast('âœ“ Google Calendar ouvert !');
}

// â”€â”€ PLANNING
function renderPlanning(){
  const g=document.getElementById('weekGrid');g.innerHTML='';
  state.weekPlan.forEach((day,di)=>{
    const row=document.createElement('div');row.className='wgr';
    const lbl=document.createElement('div');lbl.className='wgd';lbl.textContent=day.day;
    const tasks=document.createElement('div');tasks.className='wgt';
    function refresh(){
      tasks.innerHTML='';
      day.tasks.forEach((t,ti)=>{
        const chip=document.createElement('span');chip.className=`tc ${t.type}`;
        chip.innerHTML=`${t.text}<button class="cd" onclick="delTask(${di},${ti})">âœ•</button>`;
        tasks.appendChild(chip);
      });
      const ar=document.createElement('div');ar.className='atr';
      ar.innerHTML=`<input class="at-in" id="ti${di}" placeholder="Ajouter..."/><select class="at-sel" id="tt${di}"><option value="cours">ğŸ“˜ Cours</option><option value="exo">ğŸ“ Exo</option><option value="revise">ğŸ” RÃ©vision</option></select><button class="at-btn" onclick="addTask(${di})">+</button>`;
      tasks.appendChild(ar);
    }
    refresh();row.appendChild(lbl);row.appendChild(tasks);g.appendChild(row);
  });
}
function addTask(di){const inp=document.getElementById(`ti${di}`),type=document.getElementById(`tt${di}`).value,text=inp.value.trim();if(!text)return;state.weekPlan[di].tasks.push({text,type});save();renderPlanning();toast('âœ“ TÃ¢che ajoutÃ©e');}
function delTask(di,ti){state.weekPlan[di].tasks.splice(ti,1);save();renderPlanning();}

// â”€â”€ COURS
function renderCours(){
  const list=document.getElementById('chapList');list.innerHTML='';
  state.chapters.forEach((ch,i)=>{
    const el=document.createElement('div');el.className='chap-it';
    el.innerHTML=`<div class="chap-num">${ch.num}</div>
    <div class="chap-body">
      <div class="chap-top">
        <input class="chap-ni" value="${ch.name}" placeholder="Nom du chapitre" oninput="state.chapters[${i}].name=this.value;save()"/>
        <select class="chap-st" onchange="state.chapters[${i}].status=this.value;save();renderCours()">
          <option value="locked" ${ch.status==='locked'?'selected':''}>ğŸ”’ Ã€ venir</option>
          <option value="current" ${ch.status==='current'?'selected':''}>ğŸ“– En cours</option>
          <option value="done" ${ch.status==='done'?'selected':''}>âœ… TerminÃ©</option>
        </select>
        <button class="del" onclick="delChap(${i})">ğŸ—‘</button>
      </div>
      <div class="chap-links">
        <div class="cl-f"><label>ğŸ“„ PDF</label><input value="${ch.fiche||''}" placeholder="Lien Google Drive PDF..." oninput="state.chapters[${i}].fiche=this.value;save()"/></div>
        <div class="cl-f"><label>ğŸ¬ VidÃ©o</label><input value="${ch.video||''}" placeholder="Lien YouTube..." oninput="state.chapters[${i}].video=this.value;save()"/></div>
        <div class="cl-f"><label>ğŸ“ Exos</label><input value="${ch.exercices||''}" placeholder="Lien Google Doc..." oninput="state.chapters[${i}].exercices=this.value;save()"/></div>
      </div>
      <textarea class="chap-desc" placeholder="Description du chapitre (affichÃ©e aux Ã©lÃ¨ves)..." oninput="state.chapters[${i}].desc=this.value;save()">${ch.desc||''}</textarea>
    </div>`;
    list.appendChild(el);
  });
}
function addChap(){const n=state.chapters.length+1;state.chapters.push({num:n,name:`Chapitre ${n}`,meta:'Fiche Â· VidÃ©o Â· Exercices',desc:'',status:'locked',fiche:'',video:'',exercices:''});save();renderCours();toast('âœ“ Chapitre ajoutÃ©');}
function delChap(i){if(confirm('Supprimer ce chapitre ?')){state.chapters.splice(i,1);save();renderCours();toast('âœ“ SupprimÃ©');}}

// â”€â”€ REPLAYS
function renderReplays(){
  const list=document.getElementById('replayList');list.innerHTML='';
  const empty=document.getElementById('noR');
  if(!state.replays.length){empty.style.display='block';return;}empty.style.display='none';
  state.replays.forEach((r,i)=>{
    const el=document.createElement('div');el.className='li';
    el.innerHTML=`<div class="li-ic">ğŸ¥</div><div class="li-info"><div class="li-name">${r.title}</div><div class="li-meta">${r.date} Â· ${r.duration}${r.url&&r.url!='#'?` Â· <a href="${r.url}" target="_blank" style="color:var(--acc2)">Voir</a>`:''}</div></div><button class="del" onclick="delReplay(${i})">ğŸ—‘</button>`;
    list.appendChild(el);
  });
}
function addReplay(){
  const title=document.getElementById('rTit').value.trim(),date=document.getElementById('rDate').value.trim(),duration=document.getElementById('rDur').value.trim()||'?',url=document.getElementById('rUrl').value.trim()||'#';
  if(!title||!date){toast('âš ï¸ Titre et date requis','var(--gold)');return;}
  state.replays.unshift({title,date,duration,url});save();renderReplays();
  ['rTit','rDate','rDur','rUrl'].forEach(id=>document.getElementById(id).value='');toast('âœ“ Replay ajoutÃ© !');
}
function delReplay(i){state.replays.splice(i,1);save();renderReplays();toast('âœ“ SupprimÃ©');}

// â”€â”€ EVALS
function renderEvals(){
  const list=document.getElementById('evalList');list.innerHTML='';
  const empty=document.getElementById('noE');
  if(!state.evals.length){empty.style.display='block';return;}empty.style.display='none';
  state.evals.forEach((e,i)=>{
    const b={good:'bg',ok:'bo',bad:'br2'}[e.noteClass]||'br2';
    const el=document.createElement('div');el.className='li';
    el.innerHTML=`<div class="li-ic">ğŸ“Š</div><div class="li-info"><div class="li-name">${e.name}</div><div class="li-meta">${e.date}${e.comment?' Â· '+e.comment.slice(0,45)+'â€¦':''}</div></div><span class="badge ${b}">${e.note}/${e.max}</span><button class="del" onclick="delEval(${i})">ğŸ—‘</button>`;
    list.appendChild(el);
  });
}
function addEval(){
  const name=document.getElementById('eName').value.trim(),date=document.getElementById('eDate').value.trim(),note=parseFloat(document.getElementById('eNote').value),max=parseFloat(document.getElementById('eMax').value)||20,noteClass=document.getElementById('eCls').value,comment=document.getElementById('eCmt').value.trim(),tagsRaw=document.getElementById('eTags').value.trim();
  if(!name||!date||isNaN(note)){toast('âš ï¸ Remplis nom, date et note','var(--gold)');return;}
  state.evals.unshift({name,date,note,max,noteClass,comment,tags:tagsRaw?tagsRaw.split(',').map(t=>t.trim()):[]});
  save();renderEvals();['eName','eDate','eNote','eCmt','eTags'].forEach(id=>document.getElementById(id).value='');document.getElementById('eMax').value='20';
  toast('âœ“ Ã‰valuation ajoutÃ©e !');
}
function delEval(i){state.evals.splice(i,1);save();renderEvals();toast('âœ“ SupprimÃ©e');}

// â”€â”€ OBJECTIFS
function renderObj(){
  const list=document.getElementById('objList');list.innerHTML='';
  if(!state.objectives.length){list.innerHTML='<div style="text-align:center;padding:18px;color:var(--mu);font-size:13px">Aucun objectif.</div>';return;}
  state.objectives.forEach((o,i)=>{
    const el=document.createElement('div');el.className='oi';
    el.innerHTML=`<div class="od"></div><span style="flex:1">${o.text}</span><button class="del" onclick="delObj(${i})">ğŸ—‘</button>`;
    list.appendChild(el);
  });
}
function addObj(){const text=document.getElementById('newObj').value.trim();if(!text)return;state.objectives.push({text,done:false,source:'coach'});save();renderObj();document.getElementById('newObj').value='';toast('âœ“ Objectif ajoutÃ© !');}
function delObj(i){state.objectives.splice(i,1);save();renderObj();toast('âœ“ SupprimÃ©');}

// â”€â”€ MESSAGE
function renderMsg(){
  document.getElementById('msgTit').value=state.message.title||'';
  document.getElementById('msgBody').value=state.message.body||'';
  document.getElementById('msgCta').value=state.message.cta||'';
  updatePrev();
  ['msgTit','msgBody','msgCta'].forEach(id=>document.getElementById(id).addEventListener('input',updatePrev));
}
function updatePrev(){const t=document.getElementById('msgTit').value||'â€”',b=document.getElementById('msgBody').value||'â€”',c=document.getElementById('msgCta').value;document.getElementById('msgPrev').innerHTML=`<strong style="color:var(--tx)">${t}</strong><br/><br/>${b}${c?`<br/><br/><em style="color:var(--acc2)">${c}</em>`:''}`;} 
function saveMsg(){state.message={title:document.getElementById('msgTit').value,body:document.getElementById('msgBody').value,cta:document.getElementById('msgCta').value};save();toast('âœ“ Message sauvegardÃ© !');}

// â”€â”€ SAVE ALL
function saveAll(){
  const map={mTit:'meetTitle',mDate:'meetDate',mUrl:'meetUrl'};
  Object.entries(map).forEach(([k,v])=>{const el=document.getElementById(k);if(el)state[v]=el.value;});
  save();toast('âœ“ Tout sauvegardÃ© !');
}

// INIT
renderStudents();
</script>
</body>
</html>
